function ignore(){}function id(n){return n}function fst(n){return n[0]}function snd(n){return n[1]}function trd(n){return n[2]}IntelliFactory={Runtime:{Ctor:function(n,t){return n.prototype=t.prototype,n},Class:function(n,t,i){var u=n,f,r,e;if(t){u=new t;for(f in n)u[f]=n[f]}if(r=function(n){if(n)for(var t in n)this[t]=n[t]},r.prototype=u,i)for(e in i)r[e]=i[e];return r},Clone:function(n){var t={};for(var i in n)t[i]=n[i];return t},NewObject:function(n){for(var i={},t=0;t<n.length;t++)i[n[t][0]]=n[t][1];return i},DeleteEmptyFields:function(n,t){for(var r,i=0;i<t.length;i++)r=t[i],n[r]===void 0&&delete n[r];return n},GetOptional:function(n){return n===void 0?null:{$:1,$0:n}},SetOptional:function(n,t,i){i?n[t]=i.$0:delete n[t]},SetOrDelete:function(n,t,i){i===void 0?delete n[t]:n[t]=i},Apply:function(n,t,i){return n.apply(t,i)},Bind:function(n){return function(){return n.apply(this,arguments)}},CreateFuncWithArgs:function(n){return function(){return n(Array.prototype.slice.call(arguments))}},CreateFuncWithOnlyThis:function(n){return function(){return n(this)}},CreateFuncWithThis:function(n){return function(){return n(this).apply(null,arguments)}},CreateFuncWithThisArgs:function(n){return function(){return n(this)(Array.prototype.slice.call(arguments))}},CreateFuncWithRest:function(n,t){return function(){return t(Array.prototype.slice.call(arguments,0,n).concat([Array.prototype.slice.call(arguments,n)]))}},CreateFuncWithArgsRest:function(n,t){return function(){return t([Array.prototype.slice.call(arguments,0,n),Array.prototype.slice.call(arguments,n)])}},BindDelegate:function(n,t){var i=n.bind(t);return i.$Func=n,i.$Target=t,i},CreateDelegate:function(n){if(n.length==0)return null;if(n.length==1)return n[0];var t=function(){for(var i,t=0;t<n.length;t++)i=n[t].apply(null,arguments);return i};return t.$Invokes=n,t},CombineDelegates:function(n){for(var t,i=[],r=0;r<n.length;r++)t=n[r],t&&("$Invokes"in t?i=i.concat(t.$Invokes):i.push(t));return IntelliFactory.Runtime.CreateDelegate(i)},DelegateEqual:function(n,t){var f,e,i,r,u;if(n===t)return!0;if(n==null||t==null||(f=n.$Invokes||[n],e=t.$Invokes||[t],f.length!=e.length))return!1;for(i=0;i<f.length;i++)if(r=f[i],u=e[i],!(r===u||"$Func"in r&&"$Func"in u&&r.$Func===u.$Func&&r.$Target==u.$Target))return!1;return!0},ThisFunc:function(n){return function(){var t=Array.prototype.slice.call(arguments);return t.unshift(this),n.apply(null,t)}},ThisFuncOut:function(n){return function(){var t=Array.prototype.slice.call(arguments);return n.apply(t.shift(),t)}},ParamsFunc:function(n,t){return function(){var i=Array.prototype.slice.call(arguments);return t.apply(null,i.slice(0,n).concat([i.slice(n)]))}},ParamsFuncOut:function(n,t){return function(){var i=Array.prototype.slice.call(arguments);return t.apply(null,i.slice(0,n).concat(i[n]))}},ThisParamsFunc:function(n,t){return function(){var i=Array.prototype.slice.call(arguments);return i.unshift(this),t.apply(null,i.slice(0,n+1).concat([i.slice(n+1)]))}},ThisParamsFuncOut:function(n,t){return function(){var i=Array.prototype.slice.call(arguments);return t.apply(i.shift(),i.slice(0,n).concat(i[n]))}},Curried:function(n,t,i){return i=i||[],function(r){var u=i.concat([r===void 0?null:r]);return t==1?n.apply(null,u):t==2?function(t){return n.apply(null,u.concat([t===void 0?null:t]))}:IntelliFactory.Runtime.Curried(n,t-1,u)}},Curried2:function(n){return function(t){return function(i){return n(t,i)}}},Curried3:function(n){return function(t){return function(i){return function(r){return n(t,i,r)}}}},UnionByType:function(n,t,i){for(var u,f=typeof t,r=0;r<n.length;r++)if(u=n[r],typeof u=="number"){if(Array.isArray(t)&&(u==0||t.length==u))return{$:r,$0:t}}else if(u==f)return{$:r,$0:t};if(!i)throw new Error("Type not expected for creating Choice value.");},ScriptBasePath:"./",ScriptPath:function(n,t){return this.ScriptBasePath+(this.ScriptSkipAssemblyDir?"":n+"/")+t},OnLoad:function(n){"load"in this||(this.load=[]);this.load.push(n)},Start:function(){function n(n){for(var t=0;t<n.length;t++)n[t]()}"load"in this&&(n(this.load),this.load=[])}}};IntelliFactory.Runtime.OnLoad(function(){self.WebSharper&&WebSharper.Activator&&WebSharper.Activator.Activate&&WebSharper.Activator.Activate()});Date.now||(Date.now=function(){return(new Date).getTime()});Math.trunc||(Math.trunc=function(n){return n<0?Math.ceil(n):Math.floor(n)});Object.setPrototypeOf||(Object.setPrototypeOf=function(n,t){return n.__proto__=t,n});console||(console={count:ignore,dir:ignore,error:ignore,group:ignore,groupEnd:ignore,info:ignore,log:ignore,profile:ignore,profileEnd:ignore,time:ignore,timeEnd:ignore,trace:ignore,warn:ignore});
(function(){for(var i=0,t=["webkit","moz"],n=0;n<t.length&&!window.requestAnimationFrame;++n)window.requestAnimationFrame=window[t[n]+"RequestAnimationFrame"],window.cancelAnimationFrame=window[t[n]+"CancelAnimationFrame"]||window[t[n]+"CancelRequestAnimationFrame"];window.requestAnimationFrame||(window.requestAnimationFrame=function(n){var t=(new Date).getTime(),r=Math.max(0,16-(t-i)),u=window.setTimeout(function(){n(t+r)},r);return i=t+r,u});window.cancelAnimationFrame||(window.cancelAnimationFrame=function(n){clearTimeout(n)})})();
(function(){"use strict";var a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C,D,E,F,G,H,I,J,K,L,M,N,O,P,Q,R,S,T,U,V,W,X,Y,Z,_0,_1,_2,_3,_4,_5,_6,_7,_8,_9,_,$,ba,bb,bc,bd,be,bf,bg,bh,bi,bj,bk,bl,bm,bn,bo,bp,bq,br,bs,bt,bu,bv,bw,bx,by,bz,bA,bB,bC,bD,bE,bF,bG,bH,bI,bJ,bK,bL,bM,bN,bO,bP,bQ,bR,bS,bT,bU,bV,bW;a=self;b=a.Site=a.Site||{};c=b.Client=b.Client||{};d=b.Samples=b.Samples||{};e=d.Set=d.Set||{};f=a.EventTarget;g=a.WindowOrWorkerGlobalScope;h=a.WebSharper=a.WebSharper||{};i=h.JavaScript=h.JavaScript||{};j=i.JS=i.JS||{};k=d.Sample=d.Sample||{};l=h.Operators=h.Operators||{};m=h.Obj=h.Obj||{};n=h.UI=h.UI||{};o=n.HtmlModule=n.HtmlModule||{};p=o.attr=o.attr||{};q=h.List=h.List||{};r=n.Doc=n.Doc||{};s=a.StartupCode$WebRTCSamples$Client=a.StartupCode$WebRTCSamples$Client||{};t=q.T=q.T||{};u=a.Node;v=h.Unchecked=h.Unchecked||{};w=n.AttrProxy=n.AttrProxy||{};x=i.Pervasives=i.Pervasives||{};y=n.AttrModule=n.AttrModule||{};z=n.Array=n.Array||{};A=n.Client=n.Client||{};B=A.Templates=A.Templates||{};C=b.MinMaxTimeDomain=b.MinMaxTimeDomain||{};D=b.ASCIICamera=b.ASCIICamera||{};E=D.Application=D.Application||{};F=n.Attrs=n.Attrs||{};G=n.DomUtility=n.DomUtility||{};H=n.View=n.View||{};I=h.Arrays=h.Arrays||{};J=a.Object;K=h.Collections=h.Collections||{};L=K.Dictionary=K.Dictionary||{};M=h.Seq=h.Seq||{};N=a.StartupCode$WebRTCSamples$MinMaxTimeDomain=a.StartupCode$WebRTCSamples$MinMaxTimeDomain||{};O=a.StartupCode$WebRTCSamples$ASCIICamera=a.StartupCode$WebRTCSamples$ASCIICamera||{};P=n.Snap=n.Snap||{};Q=n.DocElemNode=n.DocElemNode||{};R=a.CharacterData;S=h.Enumerator=h.Enumerator||{};T=a.StartupCode$WebSharper_UI$Templates=a.StartupCode$WebSharper_UI$Templates||{};U=K.HashSet=K.HashSet||{};V=a.StartupCode$WebSharper_UI$DomUtility=a.StartupCode$WebSharper_UI$DomUtility||{};W=d.Builder=d.Builder||{};X=n.Var$1=n.Var$1||{};Y=S.T=S.T||{};Z=n.Elt=n.Elt||{};_0=A.Attrs=A.Attrs||{};_1=_0.Dyn=_0.Dyn||{};_2=K.DictionaryUtil=K.DictionaryUtil||{};_3=B.Prepare=B.Prepare||{};_4=h.Slice=h.Slice||{};_5=K.KeyCollection=K.KeyCollection||{};_6=b.AudioHolder=b.AudioHolder||{};_7=n.Var=n.Var||{};_8=n.ConcreteVar=n.ConcreteVar||{};_9=D.Camera=D.Camera||{};_=n.Docs=n.Docs||{};$=n.Updates=n.Updates||{};ba=h.Strings=h.Strings||{};bb=n.An=n.An||{};bc=A.Settings=A.Settings||{};bd=n.Abbrev=n.Abbrev||{};be=bd.Mailbox=bd.Mailbox||{};bf=bd.Fresh=bd.Fresh||{};bg=a.Element;bh=a.HTMLElement;bi=D.Video=D.Video||{};bj=a.HTMLMediaElement;bk=D.Ascii=D.Ascii||{};bl=a.StartupCode$WebSharper_UI$Attr_Client=a.StartupCode$WebSharper_UI$Attr_Client||{};bm=A.Docs=A.Docs||{};bn=bm.RunState=bm.RunState||{};bo=bm.NodeSet=bm.NodeSet||{};bp=n.Anims=n.Anims||{};bq=a.StartupCode$WebSharper_UI$Doc_Proxy=a.StartupCode$WebSharper_UI$Doc_Proxy||{};br=a.StartupCode$WebRTCSamples$AudioHolder=a.StartupCode$WebRTCSamples$AudioHolder||{};bs=a.AudioNode;bt=a.ArrayBufferView;bu=bk.Color=bk.Color||{};bv=K.HashSetUtil=K.HashSetUtil||{};bw=h.Queue=h.Queue||{};bx=a.StartupCode$WebSharper_UI$Animation=a.StartupCode$WebSharper_UI$Animation||{};by=h.Concurrency=h.Concurrency||{};bz=n.AppendList=n.AppendList||{};bA=a.StartupCode$WebSharper_UI$Abbrev=a.StartupCode$WebSharper_UI$Abbrev||{};bB=n.Easing=n.Easing||{};bC=by.AsyncBody=by.AsyncBody||{};bD=a.StartupCode$WebSharper_Main$Concurrency=a.StartupCode$WebSharper_Main$Concurrency||{};bE=by.CT=by.CT||{};bF=bd.HashSet=bd.HashSet||{};bG=by.Scheduler=by.Scheduler||{};bH=h.CancellationTokenSource=h.CancellationTokenSource||{};bI=bm.DomNodes=bm.DomNodes||{};bJ=a.Error;bK=h.OperationCanceledException=h.OperationCanceledException||{};bL=h.Lazy=h.Lazy||{};bM=a.StartupCode$WebSharper_UI$AppendList=a.StartupCode$WebSharper_UI$AppendList||{};bN=h.LazyExtensionsProxy=h.LazyExtensionsProxy||{};bO=bN.LazyRecord=bN.LazyRecord||{};bP=a.IntelliFactory;bQ=bP&&bP.Runtime;bR=a.Math;bS=a.console;bT=a.jQuery;bU=a.navigator;bV=a.URL;bW=a.Date;c.Main=function(){return c.All().Show();};c.All=function(){s.$cctor();return s.All;};e=d.Set=bQ.Class({Show:function(){var bX;bX=this;return a.jQuery(function(){var bY;function bZ(b0,b1){a.jQuery("#sample-navs ul").children("li").removeClass("active");a.jQuery(b1).addClass("active");return b0.Show();}self.document;bY=r.Element("ul",[w.Create("class","nav nav-pills")],[r.Concat(q.mapi(function(b0,b1){return r.Element("li",[y.OnAfterRender(function(b2){if(b0===0)bZ(b1,b2);}),y.Handler("click",function(b2){return function(){return bZ(b1,b2);};})],[r.Element("a",[w.Create("href","#")],[r.TextNode(b1.Title)])]);},bX.$0))]);B.LoadLocalTemplates("");return r.RunAppendById("sample-navs",bY);});}},null,e);e.Singleton=function(bX){return new e({$:0,$0:q.ofArray([bX])});};e.Create=function(bX){return new e({$:0,$0:q.ofSeq(M.delay(function(){return M.collect(function(bY){return bY.$0;},bX);}))});};j.GetFieldValues=function(bX){var bY,bZ;bY=[];for(var b0 in bX)bY.push(bX[b0]);return bY;};k=d.Sample=bQ.Class({Show:function(){var bX,bY,bZ,b0;bX=this;bY=self.document.getElementById("sample-main");bZ=self.document.getElementById("sample-side");d.Clear(bY);d.Clear(bZ);this.Render(bY);b0=r.Concat([r.Element("div",[y.OnAfterRender(function(b1){var b2,b3;b2=self.document.getElementById(bX.Id);v.Equals(b2,null)?void 0:(b3=b2.cloneNode(true),b3.attributes.removeNamedItem("id"),b1.appendChild(b3));})],[]),r.Element("a",[w.Create("class","btn btn-primary btn-lg"),w.Create("href","http://github.com/intellifactory/websharper.babylonjs/blob/master/Site/"+this.FileName)],[r.TextNode("Source")])]);B.LoadLocalTemplates("");r.RunAppendById("sample-side",b0);}},null,k);k.New=function(bX,bY,bZ,b0,b1){return new k({FileName:bX,Id:bY,Keywords:bZ,Render:b0,Title:b1});};l.FailWith=function(bX){throw new bJ(bX);};l.KeyValue=function(bX){return[bX.K,bX.V];};l.toInt=function(bX){var bY;bY=l.toUInt(bX);return bY>=2147483648?bY-4294967296:bY;};l.toUInt=function(bX){return(bX<0?bR.ceil(bX):bR.floor(bX))>>>0;};m=h.Obj=bQ.Class({Equals:function(bX){return this===bX;},GetHashCode:function(){return -1;}},null,m);m.New=bQ.Ctor(function(){},m);p=o.attr=bQ.Class({},m,p);q.mapi=function(bX,bY){var bZ,b0,b1,b2,b3,b4;if(bY.$==0)return bY;else{b3=new t({$:1});bZ=b3;b0=bY;b1=0;b2=true;while(b2){bZ.$0=bX(b1,b0.$0);b0=b0.$1;b0.$==0?b2=false:(bZ=(b4=new t({$:1}),bZ.$1=b4,b4),b1=b1+1);}bZ.$1=t.Empty;return b3;}};q.ofArray=function(bX){var bY,bZ,b0;bY=t.Empty;for(bZ=I.length(bX)-1,b0=0;bZ>=b0;bZ--)bY=new t({$:1,$0:I.get(bX,bZ),$1:bY});return bY;};q.ofSeq=function(bX){var bY,bZ,b0,b1,b2,b3;if(bX instanceof t)return bX;else if(bX instanceof a.Array)return q.ofArray(bX);else{bY=S.Get(bX);try{b0=bY.MoveNext();if(!b0)bZ=t.Empty;else{b2=new t({$:1});b1=b2;while(b0){b1.$0=bY.Current();bY.MoveNext()?b1=(b3=new t({$:1}),b1.$1=b3,b3):b0=false;}b1.$1=t.Empty;bZ=b2;}return bZ;}finally{if(typeof bY=="object"&&"Dispose"in bY)bY.Dispose();}}};q.head=function(bX){return bX.$==1?bX.$0:q.listEmpty();};q.tail=function(bX){return bX.$==1?bX.$1:q.listEmpty();};q.listEmpty=function(){return l.FailWith("The input list was empty.");};q.iteri=function(bX,bY){var bZ,b0;bZ=bY;b0=0;while(bZ.$==1){bX(b0,q.head(bZ));bZ=q.tail(bZ);b0=b0+1;}};r=n.Doc=bQ.Class({},m,r);r.Concat=function(bX){var bY;bY=z.ofSeqNonCopying(bX);return z.TreeReduce(r.get_Empty(),r.Append,bY);};r.TextNode=function(bX){return r.Mk({$:5,$0:G.CreateText(bX)},H.Const());};r.Append=function(bX,bY){return r.Mk({$:0,$0:bX.docNode,$1:bY.docNode},H.Map2Unit(bX.updates,bY.updates));};r.get_Empty=function(){return r.Mk(null,H.Const());};r.RunAppendById=function(bX,bY){var bZ;bZ=G.Doc().getElementById(bX);v.Equals(bZ,null)?l.FailWith("invalid id: "+bX):r.RunAppend(bZ,bY);};r.Element=function(bX,bY,bZ){var b0,b1;b0=w.Concat(bY);b1=r.Concat(bZ);return Z.New(G.CreateElement(bX),b0,b1);};r.Mk=function(bX,bY){return new r.New(bX,bY);};r.RunAppend=function(bX,bY){var bZ;bZ=self.document.createTextNode("");bX.appendChild(bZ);r.RunBefore(bZ,bY);};r.RunBefore=function(bX,bY){var bZ;bZ=self.document.createTextNode("");bX.parentNode.insertBefore(bZ,bX);r.RunBetween(bZ,bX,bY);};r.RunBetween=function(bX,bY,bZ){var b0;_.LinkPrevElement(bY,bZ.docNode);b0=_.CreateDelimitedRunState(bX,bY,bZ.docNode);H.Sink(bb.get_UseAnimations()||bc.BatchUpdatesEnabled()?be.StartProcessor(_.PerformAnimatedUpdate(false,b0,bZ.docNode)):function(){_.PerformSyncUpdate(false,b0,bZ.docNode);},bZ.updates);};r.Run=function(bX,bY){_.LinkElement(bX,bY.docNode);r.RunInPlace(false,bX,bY);};r.TextView=function(bX){var bY;bY=_.CreateTextNode();return r.Mk({$:4,$0:bY},H.Map(function(bZ){_.UpdateTextNode(bY,bZ);},bX));};r.BindView=function(bX,bY){return r.EmbedView(H.Map(bX,bY));};r.RunInPlace=function(bX,bY,bZ){var b0;b0=_.CreateRunState(bY,bZ.docNode);H.Sink(bb.get_UseAnimations()||bc.BatchUpdatesEnabled()?be.StartProcessor(_.PerformAnimatedUpdate(bX,b0,bZ.docNode)):function(){_.PerformSyncUpdate(bX,b0,bZ.docNode);},bZ.updates);};r.EmbedView=function(bX){var bY;bY=_.CreateEmbedNode();return r.Mk({$:2,$0:bY},H.Map(a.ignore,H.Bind(function(bZ){_.UpdateEmbedNode(bY,bZ.docNode);return bZ.updates;},bX)));};r.New=bQ.Ctor(function(bX,bY){m.New.call(this);this.docNode=bX;this.updates=bY;},r);s.$cctor=function(){s.$cctor=a.ignore;s.All=e.Create([e.Singleton(C.Sample()),e.Singleton(E.Sample())]);};t=q.T=bQ.Class({GetEnumerator:function(){return new Y.New(this,null,function(bX){var bY;bY=bX.s;return bY.$==0?false:(bX.c=bY.$0,bX.s=bY.$1,true);},void 0);},GetEnumerator0:function(){return S.Get(this);}},null,t);t.Empty=new t({$:0});d.Clear=function(bX){while(bX.hasChildNodes())bX.removeChild(bX.firstChild);};d.Build=function(){return W.New(null,null,t.Empty,null,null);};d.req=function(bX,bY){return bY!=null&&bY.$==1?bY.$0:l.FailWith("Required property not set: "+bX);};d.op_PlusPlus=function(bX,bY){return bX==null?bY:bX;};v.Equals=function(bX,bY){var bZ,b0,b1,b2;if(bX===bY)return true;else{bZ=typeof bX;if(bZ=="object"){if(bX===null||bX===void 0||bY===null||bY===void 0)return false;else if("Equals"in bX)return bX.Equals(bY);else if(bX instanceof a.Array&&bY instanceof a.Array)return v.arrayEquals(bX,bY);else if(bX instanceof a.Date&&bY instanceof a.Date)return v.dateEquals(bX,bY);else{b0=[true];for(var b3 in bX)if(function(b4){b0[0]=!bX.hasOwnProperty(b4)||bY.hasOwnProperty(b4)&&v.Equals(bX[b4],bY[b4]);return!b0[0];}(b3))break;if(b0[0]){for(var b4 in bY)if(function(b5){b0[0]=!bY.hasOwnProperty(b5)||bX.hasOwnProperty(b5);return!b0[0];}(b4))break;}return b0[0];}}else return bZ=="function"&&("$Func"in bX?bX.$Func===bY.$Func&&bX.$Target===bY.$Target:"$Invokes"in bX&&"$Invokes"in bY&&v.arrayEquals(bX.$Invokes,bY.$Invokes));}};v.arrayEquals=function(bX,bY){var bZ,b0;if(I.length(bX)===I.length(bY)){bZ=true;b0=0;while(bZ&&b0<I.length(bX)){!v.Equals(I.get(bX,b0),I.get(bY,b0))?bZ=false:void 0;b0=b0+1;}return bZ;}else return false;};v.dateEquals=function(bX,bY){return bX.getTime()===bY.getTime();};v.Hash=function(bX){var bY;bY=typeof bX;return bY=="function"?0:bY=="boolean"?bX?1:0:bY=="number"?bX:bY=="string"?v.hashString(bX):bY=="object"?bX==null?0:bX instanceof a.Array?v.hashArray(bX):v.hashObject(bX):0;};v.hashString=function(bX){var bY,bZ,b0;if(bX===null)return 0;else{bY=5381;for(bZ=0,b0=bX.length-1;bZ<=b0;bZ++)bY=v.hashMix(bY,bX[bZ].charCodeAt());return bY;}};v.hashArray=function(bX){var bY,bZ,b0;bY=-34948909;for(bZ=0,b0=I.length(bX)-1;bZ<=b0;bZ++)bY=v.hashMix(bY,v.Hash(I.get(bX,bZ)));return bY;};v.hashObject=function(bX){var bY,bZ;if("GetHashCode"in bX)return bX.GetHashCode();else{bY=[0];for(var b0 in bX)if(function(b1){bY[0]=v.hashMix(v.hashMix(bY[0],v.hashString(b1)),v.Hash(bX[b1]));return false;}(b0))break;return bY[0];}};v.hashMix=function(bX,bY){return(bX<<5)+bX+bY;};v.Compare=function(bX,bY){var bZ,b0,b1,b2,b3,b4;if(bX===bY)return 0;else{b0=typeof bX;switch(b0=="function"?1:b0=="boolean"?2:b0=="number"?2:b0=="string"?2:b0=="object"?3:0){case 0:return typeof bY=="undefined"?0:-1;case 1:return l.FailWith("Cannot compare function values.");case 2:return bX<bY?-1:1;case 3:if(bX===null)b1=-1;else if(bY===null)b1=1;else if("CompareTo"in bX)b1=bX.CompareTo(bY);else if("CompareTo0"in bX)b1=bX.CompareTo0(bY);else if(bX instanceof a.Array&&bY instanceof a.Array)b1=v.compareArrays(bX,bY);else if(bX instanceof a.Date&&bY instanceof a.Date)b1=v.compareDates(bX,bY);else{b2=[0];for(var b5 in bX)if(function(b6){return!bX.hasOwnProperty(b6)?false:!bY.hasOwnProperty(b6)?(b2[0]=1,true):(b2[0]=v.Compare(bX[b6],bY[b6]),b2[0]!==0);}(b5))break;if(b2[0]===0){for(var b6 in bY)if(function(b7){return!bY.hasOwnProperty(b7)?false:!bX.hasOwnProperty(b7)&&(b2[0]=-1,true);}(b6))break;}b1=b2[0];}return b1;}}};v.compareArrays=function(bX,bY){var bZ,b0;if(I.length(bX)<I.length(bY))return -1;else if(I.length(bX)>I.length(bY))return 1;else{bZ=0;b0=0;while(bZ===0&&b0<I.length(bX)){bZ=v.Compare(I.get(bX,b0),I.get(bY,b0));b0=b0+1;}return bZ;}};v.compareDates=function(bX,bY){return v.Compare(bX.getTime(),bY.getTime());};w=n.AttrProxy=bQ.Class({},null,w);w.Create=function(bX,bY){return F.Static(function(bZ){G.SetAttr(bZ,bX,bY);});};w.Concat=function(bX){var bY;bY=z.ofSeqNonCopying(bX);return z.TreeReduce(F.EmptyAttr(),w.Append,bY);};w.Append=function(bX,bY){return F.AppendTree(bX,bY);};x.NewFromSeq=function(bX){var bY,bZ,b0;bY={};bZ=S.Get(bX);try{while(bZ.MoveNext()){b0=bZ.Current();bY[b0[0]]=b0[1];}}finally{if(typeof bZ=="object"&&"Dispose"in bZ)bZ.Dispose();}return bY;};y.OnAfterRender=function(bX){return new w({$:4,$0:bX});};y.Handler=function(bX,bY){return F.Static(function(bZ){bZ.addEventListener(bX,function(b0){return(bY(bZ))(b0);},false);});};z.ofSeqNonCopying=function(bX){var bY,bZ;if(bX instanceof a.Array)return bX;else if(bX instanceof t)return I.ofList(bX);else if(bX===null)return[];else{bY=[];bZ=S.Get(bX);try{while(bZ.MoveNext())bY.push(bZ.Current());return bY;}finally{if(typeof bZ=="object"&&"Dispose"in bZ)bZ.Dispose();}}};z.TreeReduce=function(bX,bY,bZ){var b0;function b1(b2,b3){var b4,b5;return b3<=0?bX:b3===1&&(b2>=0&&b2<b0)?I.get(bZ,b2):(b5=b3/2>>0,bY(b1(b2,b5),b1(b2+b5,b3-b5)));}b0=I.length(bZ);return b1(0,b0);};z.MapTreeReduce=function(bX,bY,bZ,b0){var b1;function b2(b3,b4){var b5,b6;return b4<=0?bY:b4===1&&(b3>=0&&b3<b1)?bX(I.get(b0,b3)):(b6=b4/2>>0,bZ(b2(b3,b6),b2(b3+b6,b4-b6)));}b1=I.length(b0);return b2(0,b1);};B.LoadLocalTemplates=function(bX){!B.LocalTemplatesLoaded()?(B.set_LocalTemplatesLoaded(true),B.LoadNestedTemplates(self.document.body,"")):void 0;B.LoadedTemplates().set_Item(bX,B.LoadedTemplateFile(""));};B.LocalTemplatesLoaded=function(){T.$cctor();return T.LocalTemplatesLoaded;};B.set_LocalTemplatesLoaded=function(bX){T.$cctor();T.LocalTemplatesLoaded=bX;};B.LoadNestedTemplates=function(bX,bY){var b0,b1,b2,b3,b4,b5,b6,b7,b8,b9,b_,b$,ca,cb;function bZ(cc){var cd,ce;if(!b0.ContainsKey(cc)){cd=(ce=null,[b1.TryGetValue(cc,{get:function(){return ce;},set:function(cf){ce=cf;}}),ce]);cd[0]?(cb.Add(cc),b1.Remove(cc),B.PrepareTemplateStrict(bY,{$:1,$0:cc},cd[1][0],{$:1,$0:cd[1][1]},{$:1,$0:bZ})):bS.warn(cb.Contains(cc)?"Encountered loop when instantiating "+cc:"Local template does not exist: "+cc);}}b0=B.LoadedTemplateFile(bY);b1=new L.New$5();b2=bX.querySelectorAll("[ws-template]");for(b3=0,b4=b2.length-1;b3<=b4;b3++){b5=b2[b3];b6=b5.getAttribute("ws-template").toLowerCase();b5.removeAttribute("ws-template");b1.set_Item(b6,[[b5],B.FakeRootSingle(b5)]);}b7=bX.querySelectorAll("[ws-children-template]");for(b8=0,b9=b7.length-1;b8<=b9;b8++){b_=b7[b8];b$=b_.getAttribute("ws-children-template").toLowerCase();b_.removeAttribute("ws-children-template");b1.set_Item(b$,(ca=G.ChildrenArray(b_),[ca,B.FakeRoot(ca)]));}cb=new U.New$3();while(b1.count>0)bZ(M.head(b1.get_Keys()));};B.LoadedTemplates=function(){T.$cctor();return T.LoadedTemplates;};B.LoadedTemplateFile=function(bX){var bY,bZ,b0;bY=(bZ=null,[B.LoadedTemplates().TryGetValue(bX,{get:function(){return bZ;},set:function(b1){bZ=b1;}}),bZ]);return bY[0]?bY[1]:(b0=new L.New$5(),(B.LoadedTemplates().set_Item(bX,b0),b0));};B.FakeRootSingle=function(bX){var bY,bZ,b0;bX.removeAttribute("ws-template");bY=bX.getAttribute("ws-replace");bY===null?void 0:(bX.removeAttribute("ws-replace"),bZ=bX.parentNode,v.Equals(bZ,null)?void 0:(b0=self.document.createElement(bX.tagName),b0.setAttribute("ws-replace",bY),bZ.replaceChild(b0,bX)));return B.FakeRoot([bX]);};B.FakeRoot=function(bX){var bY,bZ,b0;bY=self.document.createElement("div");for(bZ=0,b0=bX.length-1;bZ<=b0;bZ++)bY.appendChild(I.get(bX,bZ));return bY;};B.PrepareTemplateStrict=function(bX,bY,bZ,b0,b1){var b2,b3;function b4(b9,b_){var b$,ca,cb,cc,cd,cf,cg,ch,ci,cj,ck,cl,cm,cn,co,cp,cq,cr,cs,ct,cu,cv,cw,cx,cy,cz;function ce(cA){}while(true)switch(b9){case 0:if(b_!==null){b$=b_.nextSibling;if(v.Equals(b_.nodeType,u.TEXT_NODE))_3.convertTextNode(b_);else if(v.Equals(b_.nodeType,u.ELEMENT_NODE))b6(b_);b_=b$;}else return null;break;case 1:cf=_4.string(b_.nodeName,{$:1,$0:3},null).toLowerCase();cg=(ca=cf.indexOf("."),ca===-1?[bX,cf]:[_4.string(cf,null,{$:1,$0:ca-1}),_4.string(cf,{$:1,$0:ca+1},null)]);ch=cg[1];ci=cg[0];if(ci!==""&&!B.LoadedTemplates().ContainsKey(ci))return _3.failNotLoaded(ch);else{if(ci===""&&b1!=null)b1.$0(ch);cj=B.LoadedTemplates().get_Item(ci);if(!cj.ContainsKey(ch))return _3.failNotLoaded(ch);else{ck=cj.get_Item(ch);cl=ck.cloneNode(true);cm=new U.New$3();cn=new L.New$5();co=b_.attributes;for(cp=0,cq=co.length-1;cp<=cq;cp++){cr=co.item(cp).name.toLowerCase();cn.set_Item(cr,(cs=co.item(cp).nodeValue,cs===""?cr:cs.toLowerCase()));!cm.Add(cr)?bS.warn("Hole mapped twice",cr):void 0;}for(ct=0,cu=b_.childNodes.length-1;ct<=cu;ct++){cv=b_.childNodes[ct];v.Equals(cv.nodeType,u.ELEMENT_NODE)?!cm.Add(cv.nodeName.toLowerCase())?bS.warn("Hole filled twice",ch):void 0:void 0;}cw=b_.childNodes.length===1&&v.Equals(b_.firstChild.nodeType,u.TEXT_NODE);if(cw){cc=_3.fillTextHole(cl,b_.firstChild.textContent,ch);((function(cA){return function(cB){if(cB!=null)cA(cB.$0);};}((cd=function(cA){return function(cB){return cA.Add(cB);};}(cm),function(cA){return ce(cd(cA));})))(cc));}_3.removeHolesExcept(cl,cm);if(!cw){for(cx=0,cy=b_.childNodes.length-1;cx<=cy;cx++){cz=b_.childNodes[cx];v.Equals(cz.nodeType,u.ELEMENT_NODE)?cz.hasAttributes()?_3.fillInstanceAttrs(cl,cz):b5(cl,cz):void 0;}}_3.mapHoles(cl,cn);_3.fill(cl,b_.parentNode,b_);b_.parentNode.removeChild(b_);return;}}break;}}function b5(b9,b_){var b$,cb,cc;function ca(cd,ce){var cf,cg,ch;if(cb==="title"&&b_.hasChildNodes()){cf=bT.parseHTML(b_.textContent);b_.removeChild(b_.firstChild);for(cg=0,ch=cf.length-1;cg<=ch;cg++)b_.appendChild(I.get(cf,cg));}else null;b6(b_);return _3.fill(b_,cd,ce);}cb=b_.nodeName.toLowerCase();G.IterSelector(b9,"[ws-attr-holes]",function(cd){var ce,cf,cg,ch,ci;ce=ba.SplitChars(cd.getAttribute("ws-attr-holes"),[" "],1);for(cf=0,cg=ce.length-1;cf<=cg;cf++){ch=I.get(ce,cf);cd.setAttribute(ch,(ci=new a.RegExp("\\${"+cb+"}","ig"),cd.getAttribute(ch).replace(ci,b_.textContent)));}});cc=b9.querySelector("[ws-hole="+cb+"]");if(v.Equals(cc,null)){b$=b9.querySelector("[ws-replace="+cb+"]");return v.Equals(b$,null)?null:(ca(b$.parentNode,b$),void b$.parentNode.removeChild(b$));}else{while(cc.hasChildNodes())cc.removeChild(cc.lastChild);cc.removeAttribute("ws-hole");return ca(cc,null);}}function b6(b9){if(ba.StartsWith(b9.nodeName.toLowerCase(),"ws-"))b8(b9);else{_3.convertAttrs(b9);b7(b9.firstChild);}}function b7(b9){return b4(0,b9);}function b8(b9){return b4(1,b9);}b2=b0==null?B.FakeRoot(bZ):b0.$0;b3=(bY==null?"":bY.$0).toLowerCase();B.LoadedTemplateFile(bX).set_Item(b3,b2);I.length(bZ)>0?(function(b9){var b_,b$,ca,cb;while(true){b_=b9.querySelector("[ws-template]");if(v.Equals(b_,null)){b$=b9.querySelector("[ws-children-template]");if(v.Equals(b$,null))return null;else{ca=b$.getAttribute("ws-children-template");b$.removeAttribute("ws-children-template");B.PrepareTemplateStrict(bX,{$:1,$0:ca},G.ChildrenArray(b$),null,null);b9=b9;}}else{cb=b_.getAttribute("ws-template");(B.PrepareSingleTemplate(bX,{$:1,$0:cb},b_))(null);b9=b9;}}}(b2),b7(I.get(bZ,0))):void 0;};B.PrepareSingleTemplate=function(bX,bY,bZ){var b0,b1,b2;b0=B.FakeRootSingle(bZ);b1=[bZ];b2={$:1,$0:b0};return function(b3){B.PrepareTemplateStrict(bX,bY,b1,b2,b3);};};B.TextHoleRE=function(){T.$cctor();return T.TextHoleRE;};C.Sample=function(){N.$cctor();return N.Sample;};C.context=function(){N.$cctor();return N.context;};C.Main=function(bX){var bY,bZ;_6.StopCurrent();bY=X.Create$1("");bZ=r.BindView(function(b0){return b0===""?C.CanvasEl():r.Element("div",[],[r.TextNode(b0)]);},bY.get_View());B.LoadLocalTemplates("");r.Run(bX,bZ);!function(b0){C.um();bU.getUserMedia(b0[0],b0[1],b0[2]);}?bY.Set("Your browser does not support this feature!"):C.LoadSound(function(){bY.Set("No microphone was found!");});};C.CanvasEl=function(){N.$cctor();return N.CanvasEl;};C.um=function(){N.$cctor();return N.um;};C.LoadSound=function(bX){C.um();bU.getUserMedia({video:false,audio:true},C.Analyser,bX);};C.Analyser=function(bX){var bY,bZ;bY=C.context().createAnalyser();bY.smoothingTimeConstant=0;bY.fftSize=1024;self.sourceNode=C.javascriptNode();C.javascriptNode().connect(C.context().destination);C.javascriptNode().onaudioprocess=function(){var b0;b0=new a.Uint8Array(l.toInt(bY.frequencyBinCount));bY.getByteTimeDomainData(b0);return C.DrawTimeDomain(C.CanvasEl().elt.getContext("2d"),b0);};bZ=C.context().createMediaStreamSource(bX);bZ.connect(bY);bZ.connect(C.context().destination);_6.SetCurrent(bZ,C.javascriptNode());bY.connect(C.javascriptNode());};C.javascriptNode=function(){N.$cctor();return N.javascriptNode;};C.DrawTimeDomain=function(bX,bY){var bZ,b0,b1,b2,b3,b4,b5;bZ=bT(C.CanvasEl().elt);b0=bZ.width();b1=bZ.height();b2=[9999999];b3=[0];q.iteri(function(b6,b7){var b8;b8=b7/256;b8>b3[0]?b3[0]=b8:void 0;return b8<b2[0]?void(b2[0]=b8):null;},C.ToList(bY));b4=b1-b1*b3[0]-1;b5=b1-b1*b2[0]-1;bX.fillStyle="#ffffff";bX.fillRect(C.column(),b5,1,b4-b5);C.set_column(C.column()+1);C.column()>=b0?(C.set_column(0),bX.clearRect(0,0,b0,b1)):void 0;};C.ToList=function(bX){var bY,bZ,b0;bY=bX.length-1;bZ=t.Empty;while(true)if(bY<=-1)return bZ;else{b0=bY;bY=b0-1;bZ=new t({$:1,$0:bX[b0],$1:bZ});}};C.column=function(){N.$cctor();return N.column;};C.set_column=function(bX){N.$cctor();N.column=bX;};E.Sample=function(){O.$cctor();return O.Sample;};E.Main=function(bX){var bY,bZ,b0;_6.StopCurrent();D.SetupRequestAnimFrame();bY=X.Create$1("");bZ=r.Element("pre",[w.Create("style",E.style())],[r.TextView(E.txt().get_View())]);b0=r.BindView(function(b1){return b1===""?bZ:r.Element("div",[],[r.TextNode(b1)]);},bY.get_View());B.LoadLocalTemplates("");r.Run(bX,b0);!function(b1){D.UserMedia();bU.getUserMedia(b1[0],b1[1],b1[2]);}?bY.Set("Your browser does not support this feature!"):_9.Start(function(b1){E.Draw(b1);},_9.InitVideoStream(E.video().elt,function(){bY.Set("No camera was found!");}));};E.video=function(){O.$cctor();return O.video;};E.Draw=function(bX){var bY;bY=bX.Video;E.canvas().elt.getContext("2d").drawImage(bY,0,0,a.Number(bY.width),a.Number(bY.height));E.txt().Set(bk.AsciiFromCanvas(E.canvas().elt));};E.style=function(){O.$cctor();return O.style;};E.txt=function(){O.$cctor();return O.txt;};E.canvas=function(){O.$cctor();return O.canvas;};F.Static=function(bX){return new w({$:3,$0:bX});};F.Updates=function(bX){return z.MapTreeReduce(function(bY){return bY.NChanged();},H.Const(),H.Map2Unit,bX.DynNodes);};F.AppendTree=function(bX,bY){var bZ;return bX===null?bY:bY===null?bX:(bZ=new w({$:2,$0:bX,$1:bY}),(F.SetFlags(bZ,F.Flags(bX)|F.Flags(bY)),bZ));};F.EmptyAttr=function(){bl.$cctor();return bl.EmptyAttr;};F.Insert=function(bX,bY){var bZ,b0,b1;function b2(b3){if(!(b3===null))if(b3!=null&&b3.$==1)bZ.push(b3.$0);else if(b3!=null&&b3.$==2){b2(b3.$0);b2(b3.$1);}else if(b3!=null&&b3.$==3)b3.$0(bX);else if(b3!=null&&b3.$==4)b0.push(b3.$0);}bZ=[];b0=[];b2(bY);b1=bZ.slice(0);return _1.New(bX,F.Flags(bY),b1,b0.length===0?null:{$:1,$0:function(b3){M.iter(function(b4){b4(b3);},b0);}});};F.SetFlags=function(bX,bY){bX.flags=bY;};F.Flags=function(bX){return bX!==null&&bX.hasOwnProperty("flags")?bX.flags:0;};F.HasExitAnim=function(bX){var bY;bY=2;return(bX.DynFlags&bY)===bY;};F.GetExitAnim=function(bX){return F.GetAnim(bX,function(bY,bZ){return bY.NGetExitAnim(bZ);});};F.HasEnterAnim=function(bX){var bY;bY=1;return(bX.DynFlags&bY)===bY;};F.GetEnterAnim=function(bX){return F.GetAnim(bX,function(bY,bZ){return bY.NGetEnterAnim(bZ);});};F.HasChangeAnim=function(bX){var bY;bY=4;return(bX.DynFlags&bY)===bY;};F.GetChangeAnim=function(bX){return F.GetAnim(bX,function(bY,bZ){return bY.NGetChangeAnim(bZ);});};F.GetAnim=function(bX,bY){return bb.Concat(I.map(function(bZ){return bY(bZ,bX.DynElem);},bX.DynNodes));};F.Sync=function(bX,bY){I.iter(function(bZ){bZ.NSync(bX);},bY.DynNodes);};G.SetAttr=function(bX,bY,bZ){bX.setAttribute(bY,bZ);};G.CreateText=function(bX){return G.Doc().createTextNode(bX);};G.Doc=function(){V.$cctor();return V.Doc;};G.CreateElement=function(bX){return G.Doc().createElement(bX);};G.ChildrenArray=function(bX){var bY,bZ,b0;bY=[];for(bZ=0,b0=bX.childNodes.length-1;bZ<=b0;bZ++)bY.push(bX.childNodes[bZ]);return bY;};G.IterSelector=function(bX,bY,bZ){var b0,b1,b2;b0=bX.querySelectorAll(bY);for(b1=0,b2=b0.length-1;b1<=b2;b1++)bZ(b0[b1]);};G.InsertAt=function(bX,bY,bZ){var b0;if(!(bZ.parentNode===bX&&bY===(b0=bZ.nextSibling,v.Equals(b0,null)?null:b0)))bX.insertBefore(bZ,bY);};G.RemoveNode=function(bX,bY){if(bY.parentNode===bX)bX.removeChild(bY);};H.Const=function(bX){var bY;bY=P.New({$:0,$0:bX});return function(){return bY;};};H.Map2Unit=function(bX,bY){return H.CreateLazy(function(){return P.Map2Unit(bX(),bY());});};H.CreateLazy=function(bX){var bY;bY={c:null,o:bX};return function(){var bZ,b0;bZ=bY.c;return bZ===null?(bZ=bY.o(),bY.c=bZ,(b0=bZ.s,b0!=null&&b0.$==0)?bY.o=null:P.WhenObsoleteRun(bZ,function(){bY.c=null;}),bZ):bZ;};};H.Sink=function(bX,bY){function bZ(){P.WhenRun(bY(),bX,function(){by.scheduler().Fork(bZ);});}by.scheduler().Fork(bZ);};H.Map=function(bX,bY){return H.CreateLazy(function(){return P.Map(bX,bY());});};H.Bind=function(bX,bY){return H.Join(H.Map(bX,bY));};H.Join=function(bX){return H.CreateLazy(function(){return P.Join(bX());});};H=n.View=bQ.Class({},null,H);I.get=function(bX,bY){I.checkBounds(bX,bY);return bX[bY];};I.length=function(bX){return bX.dims===2?bX.length*bX.length:bX.length;};I.checkBounds=function(bX,bY){if(bY<0||bY>=bX.length)l.FailWith("Index was outside the bounds of the array.");};I.set=function(bX,bY,bZ){I.checkBounds(bX,bY);bX[bY]=bZ;};I.ofList=function(bX){var bY,bZ;bZ=[];bY=bX;while(!(bY.$==0)){bZ.push(q.head(bY));bY=q.tail(bY);}return bZ;};I.exists=function(bX,bY){var bZ,b0,b1,b2;bZ=false;b0=0;b2=I.length(bY);while(!bZ&&b0<b2)if(bX(bY[b0]))bZ=true;else b0=b0+1;return bZ;};I.tryPick=function(bX,bY){var bZ,b0,b1;bZ=null;b0=0;while(b0<bY.length&&bZ==null){b1=bX(bY[b0]);b1!=null&&b1.$==1?bZ=b1:void 0;b0=b0+1;}return bZ;};I.tryFindIndex=function(bX,bY){var bZ,b0;bZ=null;b0=0;while(b0<bY.length&&bZ==null){bX(bY[b0])?bZ={$:1,$0:b0}:void 0;b0=b0+1;}return bZ;};I.filter=function(bX,bY){var bZ,b0,b1;bZ=[];for(b0=0,b1=bY.length-1;b0<=b1;b0++)if(bX(bY[b0]))bZ.push(bY[b0]);return bZ;};I.map=function(bX,bY){var bZ,b0,b1;bZ=new a.Array(bY.length);for(b0=0,b1=bY.length-1;b0<=b1;b0++)bZ[b0]=bX(bY[b0]);return bZ;};I.iter=function(bX,bY){var bZ,b0;for(bZ=0,b0=bY.length-1;bZ<=b0;bZ++)bX(bY[bZ]);};I.concat=function(bX){return a.Array.prototype.concat.apply([],I.ofSeq(bX));};I.pick=function(bX,bY){var bZ;bZ=I.tryPick(bX,bY);return bZ==null?l.FailWith("KeyNotFoundException"):bZ.$0;};I.ofSeq=function(bX){var bY,bZ;if(bX instanceof a.Array)return bX.slice();else if(bX instanceof t)return I.ofList(bX);else{bY=[];bZ=S.Get(bX);try{while(bZ.MoveNext())bY.push(bZ.Current());return bY;}finally{if(typeof bZ=="object"&&"Dispose"in bZ)bZ.Dispose();}}};I.foldBack=function(bX,bY,bZ){var b0,b1,b2,b3,b4;b0=bZ;b2=bY.length;for(b3=1,b4=b2;b3<=b4;b3++)b0=bX(bY[b2-b3],b0);return b0;};I.choose=function(bX,bY){var bZ,b0,b1,b2;bZ=[];for(b0=0,b1=bY.length-1;b0<=b1;b0++){b2=bX(bY[b0]);b2==null?void 0:bZ.push(b2.$0);}return bZ;};I.create=function(bX,bY){var bZ,b0,b1;bZ=new a.Array(bX);for(b0=0,b1=bX-1;b0<=b1;b0++)bZ[b0]=bY;return bZ;};I.init=function(bX,bY){var bZ,b0,b1;bX<0?l.FailWith("Negative size given."):null;bZ=new a.Array(bX);for(b0=0,b1=bX-1;b0<=b1;b0++)bZ[b0]=bY(b0);return bZ;};I.forall=function(bX,bY){var bZ,b0,b1,b2;bZ=true;b0=0;b2=I.length(bY);while(bZ&&b0<b2)if(bX(bY[b0]))b0=b0+1;else bZ=false;return bZ;};L=K.Dictionary=bQ.Class({set_Item:function(bX,bY){this.set(bX,bY);},ContainsKey:function(bX){var bY,bZ;bY=this;bZ=this.data[this.hash(bX)];return bZ==null?false:I.exists(function(b0){return bY.equals.apply(null,[(l.KeyValue(b0))[0],bX]);},bZ);},TryGetValue:function(bX,bY){var bZ,b0,b1;bZ=this;b0=this.data[this.hash(bX)];return b0==null?false:(b1=I.tryPick(function(b2){var b3;b3=l.KeyValue(b2);return bZ.equals.apply(null,[b3[0],bX])?{$:1,$0:b3[1]}:null;},b0),b1!=null&&b1.$==1&&(bY.set(b1.$0),true));},Remove:function(bX){return this.remove(bX);},get_Keys:function(){return new _5.New(this);},set:function(bX,bY){var bZ,b0,b1,b2;bZ=this;b0=this.hash(bX);b1=this.data[b0];b1==null?(this.count=this.count+1,this.data[b0]=new a.Array({K:bX,V:bY})):(b2=I.tryFindIndex(function(b3){return bZ.equals.apply(null,[(l.KeyValue(b3))[0],bX]);},b1),b2==null?(this.count=this.count+1,b1.push({K:bX,V:bY})):b1[b2.$0]={K:bX,V:bY});},remove:function(bX){var bY,bZ,b0,b1;bY=this;bZ=this.hash(bX);b0=this.data[bZ];return b0==null?false:(b1=I.filter(function(b2){return!bY.equals.apply(null,[(l.KeyValue(b2))[0],bX]);},b0),I.length(b1)<b0.length&&(this.count=this.count-1,this.data[bZ]=b1,true));},get_Item:function(bX){return this.get(bX);},get:function(bX){var bY,bZ;bY=this;bZ=this.data[this.hash(bX)];return bZ==null?_2.notPresent():I.pick(function(b0){var b1;b1=l.KeyValue(b0);return bY.equals.apply(null,[b1[0],bX])?{$:1,$0:b1[1]}:null;},bZ);},GetEnumerator:function(){return S.Get0(this);},GetEnumerator0:function(){return S.Get0(I.concat(j.GetFieldValues(this.data)));}},m,L);L.New$5=bQ.Ctor(function(){L.New$6.call(this,[],v.Equals,v.Hash);},L);L.New$6=bQ.Ctor(function(bX,bY,bZ){var b0,b1;m.New.call(this);this.equals=bY;this.hash=bZ;this.count=0;this.data=[];b0=S.Get(bX);try{while(b0.MoveNext()){b1=b0.Current();this.set(b1.K,b1.V);}}finally{if(typeof b0=="object"&&"Dispose"in b0)b0.Dispose();}},L);M.delay=function(bX){return{GetEnumerator:function(){return S.Get(bX());}};};M.collect=function(bX,bY){return M.concat(M.map(bX,bY));};M.head=function(bX){var bY;bY=S.Get(bX);try{return bY.MoveNext()?bY.Current():M.insufficient();}finally{if(typeof bY=="object"&&"Dispose"in bY)bY.Dispose();}};M.concat=function(bX){return{GetEnumerator:function(){var bY;bY=S.Get(bX);return new Y.New(null,null,function(bZ){var b0;while(true){b0=bZ.s;if(v.Equals(b0,null)){if(bY.MoveNext()){bZ.s=S.Get(bY.Current());bZ=bZ;}else{bY.Dispose();return false;}}else if(b0.MoveNext()){bZ.c=b0.Current();return true;}else{bZ.Dispose();bZ.s=null;bZ=bZ;}}},function(bZ){var b0;b0=bZ.s;!v.Equals(b0,null)?b0.Dispose():void 0;!v.Equals(bY,null)?bY.Dispose():void 0;});}};};M.map=function(bX,bY){return{GetEnumerator:function(){var bZ;bZ=S.Get(bY);return new Y.New(null,null,function(b0){return bZ.MoveNext()&&(b0.c=bX(bZ.Current()),true);},function(){bZ.Dispose();});}};};M.fold=function(bX,bY,bZ){var b0,b1;b0=bY;b1=S.Get(bZ);try{while(b1.MoveNext())b0=bX(b0,b1.Current());return b0;}finally{if(typeof b1=="object"&&"Dispose"in b1)b1.Dispose();}};M.iter=function(bX,bY){var bZ;bZ=S.Get(bY);try{while(bZ.MoveNext())bX(bZ.Current());}finally{if(typeof bZ=="object"&&"Dispose"in bZ)bZ.Dispose();}};M.max=function(bX){var bY,bZ,b0;bY=S.Get(bX);try{if(!bY.MoveNext())M.seqEmpty();bZ=bY.Current();while(bY.MoveNext()){b0=bY.Current();v.Compare(b0,bZ)===1?bZ=b0:void 0;}return bZ;}finally{if(typeof bY=="object"&&"Dispose"in bY)bY.Dispose();}};M.seqEmpty=function(){return l.FailWith("The input sequence was empty.");};N.$cctor=function(){N.$cctor=a.ignore;N.context=new(a.AudioContext||a.webkitAudioContext)();N.javascriptNode=C.context().createScriptProcessor(1024,1,1);N.CanvasEl=r.Element("canvas",[w.Create("width","800"),w.Create("height","256"),w.Create("style","background-color: black;")],[]);N.column=0;N.um=bU.getUserMedia=bU.getUserMedia||bU.webkitGetUserMedia||bU.mozGetUserMedia||bU.msGetUserMedia;N.Sample=d.Build().Id("MinMaxTimeDomain").FileName("MinMaxTimeDomain.fs").Keywords(q.ofArray(["webrtc","visualizer","time domain","microphone"])).Render(function(bX){C.Main(bX);}).Create();};O.$cctor=function(){O.$cctor=a.ignore;O.UserMedia=bU.getUserMedia=bU.getUserMedia||bU.webkitGetUserMedia||bU.mozGetUserMedia||bU.msGetUserMedia;O.width=120;O.height=90;O.characters=" .,:;i1tfLCG08@";O.video=r.Element("video",[w.Create("width",a.String(D.width())),w.Create("height",a.String(D.height()))],[]);O.canvas=r.Element("canvas",[w.Create("width",a.String(D.width())),w.Create("height",a.String(D.height()))],[]);O.style="font-family: 'Courier New', 'Courier', monospace;font-size: 10px;line-height: 10px;";O.txt=X.Create$1("");O.Sample=d.Build().Id("ASCIICamera").FileName("ASCIICamera.fs").Keywords(q.ofArray(["webrtc","camera","video","effects"])).Render(function(bX){E.Main(bX);}).Create();};P.Map2Unit=function(bX,bY){var bZ,b0,b1;function b2(){var b3,b4,b5;if(!(b3=b1.s,b3!=null&&b3.$==0||b3!=null&&b3.$==2)){b4=P.ValueAndForever(bX);b5=P.ValueAndForever(bY);b4!=null&&b4.$==1?b5!=null&&b5.$==1?b4.$0[1]&&b5.$0[1]?P.MarkForever(b1,null):P.MarkReady(b1,null):void 0:void 0;}}bZ=bX.s;b0=bY.s;return bZ!=null&&bZ.$==0?b0!=null&&b0.$==0?P.New({$:0,$0:null}):bY:b0!=null&&b0.$==0?bX:(b1=P.New({$:3,$0:[],$1:[]}),(P.When(bX,b2,b1),P.When(bY,b2,b1),b1));};P.WhenObsoleteRun=function(bX,bY){var bZ;bZ=bX.s;bZ==null?bY():bZ!=null&&bZ.$==2?bZ.$1.push(bY):bZ!=null&&bZ.$==3?bZ.$1.push(bY):void 0;};P.ValueAndForever=function(bX){var bY;bY=bX.s;return bY!=null&&bY.$==0?{$:1,$0:[bY.$0,true]}:bY!=null&&bY.$==2?{$:1,$0:[bY.$0,false]}:null;};P.MarkForever=function(bX,bY){var bZ,b0,b1,b2;bZ=bX.s;if(bZ!=null&&bZ.$==3){bX.s={$:0,$0:bY};b0=bZ.$0;for(b1=0,b2=I.length(b0)-1;b1<=b2;b1++)(I.get(b0,b1))(bY);}else void 0;};P.MarkReady=function(bX,bY){var bZ,b0,b1,b2;bZ=bX.s;if(bZ!=null&&bZ.$==3){bX.s={$:2,$0:bY,$1:bZ.$1};b0=bZ.$0;for(b1=0,b2=I.length(b0)-1;b1<=b2;b1++)(I.get(b0,b1))(bY);}else void 0;};P.When=function(bX,bY,bZ){var b0;b0=bX.s;b0==null?P.Obsolete(bZ):b0!=null&&b0.$==2?(P.EnqueueSafe(b0.$1,bZ),bY(b0.$0)):b0!=null&&b0.$==3?(b0.$0.push(bY),P.EnqueueSafe(b0.$1,bZ)):bY(b0.$0);};P.EnqueueSafe=function(bX,bY){var bZ,b0,b1,b2;bX.push(bY);if(bX.length%20===0){bZ=bX.slice(0);bw.Clear(bX);for(b0=0,b1=I.length(bZ)-1;b0<=b1;b0++){b2=I.get(bZ,b0);typeof b2=="object"?function(b3){if(b3.s)bX.push(b3);}(b2):function(b3){bX.push(b3);}(b2);}}else void 0;};P.Copy=function(bX){var bY,bZ,b0;bY=bX.s;return bY==null?bX:bY!=null&&bY.$==2?(bZ=P.New({$:2,$0:bY.$0,$1:[]}),(P.WhenObsolete(bX,bZ),bZ)):bY!=null&&bY.$==3?(b0=P.New({$:3,$0:[],$1:[]}),(P.When(bX,function(b1){P.MarkDone(b0,bX,b1);},b0),b0)):bX;};P.WhenRun=function(bX,bY,bZ){var b0;b0=bX.s;b0==null?bZ():b0!=null&&b0.$==2?(b0.$1.push(bZ),bY(b0.$0)):b0!=null&&b0.$==3?(b0.$0.push(bY),b0.$1.push(bZ)):bY(b0.$0);};P.WhenObsolete=function(bX,bY){var bZ;bZ=bX.s;bZ==null?P.Obsolete(bY):bZ!=null&&bZ.$==2?P.EnqueueSafe(bZ.$1,bY):bZ!=null&&bZ.$==3?P.EnqueueSafe(bZ.$1,bY):void 0;};P.MarkDone=function(bX,bY,bZ){var b0;if(b0=bY.s,b0!=null&&b0.$==0)P.MarkForever(bX,bZ);else P.MarkReady(bX,bZ);};P.Map=function(bX,bY){var bZ,b0;bZ=bY.s;return bZ!=null&&bZ.$==0?P.New({$:0,$0:bX(bZ.$0)}):(b0=P.New({$:3,$0:[],$1:[]}),(P.When(bY,function(b1){P.MarkDone(b0,bY,bX(b1));},b0),b0));};P.Join=function(bX){var bY;bY=P.New({$:3,$0:[],$1:[]});P.When(bX,function(bZ){var b0;b0=bZ();P.When(b0,function(b1){var b2,b3;if((b2=b0.s,b2!=null&&b2.$==0)&&(b3=bX.s,b3!=null&&b3.$==0))P.MarkForever(bY,b1);else P.MarkReady(bY,b1);},bY);},bY);return bY;};Q=n.DocElemNode=bQ.Class({Equals:function(bX){return this.ElKey===bX.ElKey;},GetHashCode:function(){return this.ElKey;}},null,Q);Q.New=function(bX,bY,bZ,b0,b1,b2){var b3;return new Q((b3={Attr:bX,Children:bY,El:b0,ElKey:b1},(bQ.SetOptional(b3,"Delimiters",bZ),bQ.SetOptional(b3,"Render",b2),b3)));};S.Get=function(bX){return bX instanceof a.Array?S.ArrayEnumerator(bX):v.Equals(typeof bX,"string")?S.StringEnumerator(bX):bX.GetEnumerator();};S.ArrayEnumerator=function(bX){return new Y.New(0,null,function(bY){var bZ;bZ=bY.s;return bZ<I.length(bX)&&(bY.c=I.get(bX,bZ),bY.s=bZ+1,true);},void 0);};S.StringEnumerator=function(bX){return new Y.New(0,null,function(bY){var bZ;bZ=bY.s;return bZ<bX.length&&(bY.c=bX[bZ],bY.s=bZ+1,true);},void 0);};S.Get0=function(bX){return bX instanceof a.Array?S.ArrayEnumerator(bX):v.Equals(typeof bX,"string")?S.StringEnumerator(bX):"GetEnumerator0"in bX?bX.GetEnumerator0():bX.GetEnumerator();};T.$cctor=function(){T.$cctor=a.ignore;T.LoadedTemplates=new L.New$5();T.LocalTemplatesLoaded=false;T.TextHoleRE="\\${([^}]+)}";};U=K.HashSet=bQ.Class({Add:function(bX){return this.add(bX);},Contains:function(bX){var bY;bY=this.data[this.hash(bX)];return bY==null?false:this.arrContains(bX,bY);},add:function(bX){var bY,bZ;bY=this.hash(bX);bZ=this.data[bY];return bZ==null?(this.data[bY]=[bX],this.count=this.count+1,true):this.arrContains(bX,bZ)?false:(bZ.push(bX),this.count=this.count+1,true);},arrContains:function(bX,bY){var bZ,b0,b1,b2;bZ=true;b0=0;b2=bY.length;while(bZ&&b0<b2)if(this.equals.apply(null,[bY[b0],bX]))bZ=false;else b0=b0+1;return!bZ;},ExceptWith:function(bX){var bY;bY=S.Get(bX);try{while(bY.MoveNext())this.Remove(bY.Current());}finally{if(typeof bY=="object"&&"Dispose"in bY)bY.Dispose();}},get_Count:function(){return this.count;},CopyTo:function(bX){var bY,bZ,b0,b1;bY=0;bZ=bv.concat(this.data);for(b0=0,b1=bZ.length-1;b0<=b1;b0++)I.set(bX,b0,bZ[b0]);},IntersectWith:function(bX){var bY,bZ,b0,b1,b2;bY=new U.New$4(bX,this.equals,this.hash);bZ=bv.concat(this.data);for(b0=0,b1=bZ.length-1;b0<=b1;b0++){b2=bZ[b0];!bY.Contains(b2)?this.Remove(b2):void 0;}},Remove:function(bX){var bY;bY=this.data[this.hash(bX)];return bY==null?false:this.arrRemove(bX,bY)&&(this.count=this.count-1,true);},arrRemove:function(bX,bY){var bZ,b0,b1,b2;bZ=true;b0=0;b2=bY.length;while(bZ&&b0<b2)if(this.equals.apply(null,[bY[b0],bX])){bY.splice.apply(bY,[b0,1]);bZ=false;}else b0=b0+1;return!bZ;},GetEnumerator:function(){return S.Get(bv.concat(this.data));},GetEnumerator0:function(){return S.Get(bv.concat(this.data));}},m,U);U.New$3=bQ.Ctor(function(){U.New$4.call(this,[],v.Equals,v.Hash);},U);U.New$4=bQ.Ctor(function(bX,bY,bZ){var b0;m.New.call(this);this.equals=bY;this.hash=bZ;this.data=[];this.count=0;b0=S.Get(bX);try{while(b0.MoveNext())this.add(b0.Current());}finally{if(typeof b0=="object"&&"Dispose"in b0)b0.Dispose();}},U);U.New$2=bQ.Ctor(function(bX){U.New$4.call(this,bX,v.Equals,v.Hash);},U);V.$cctor=function(){V.$cctor=a.ignore;V.Doc=self.document;};W=d.Builder=bQ.Class({Create:function(){var bX,bY,bZ;bX=d.req("Id",d.op_PlusPlus(this.BId,this.BTitle));bY=(bZ=d.op_PlusPlus(this.BTitle,this.BId),bZ==null?"Sample":bZ.$0);return k.New(d.req("FileName",this.BFileName),bX,this.BKeywords,d.req("Render",this.BRender),bY);},Render:function(bX){this.BRender={$:1,$0:bX};return this;},Keywords:function(bX){this.BKeywords=bX;return this;},FileName:function(bX){this.BFileName={$:1,$0:bX};return this;},Id:function(bX){this.BId={$:1,$0:bX};return this;}},null,W);W.New=function(bX,bY,bZ,b0,b1){return new W({BFileName:bX,BId:bY,BKeywords:bZ,BRender:b0,BTitle:b1});};D.width=function(){O.$cctor();return O.width;};D.height=function(){O.$cctor();return O.height;};D.SetupRequestAnimFrame=function(){a.requestAnimFrame=function(){return a.requestAnimationFrame||a.webkitRequestAnimationFrame||a.mozRequestAnimationFrame||function(bX){a.setTimeout(bX,1000/60);};}();a.cancelAnimFrame=function(){return a.cancelAnimationFrame||a.mozCancelAnimationFrame||a.clearTimeout;}();};D.UserMedia=function(){O.$cctor();return O.UserMedia;};X=n.Var$1=bQ.Class({},m,X);X.Create$1=function(bX){return new _8.New(false,P.New({$:2,$0:bX,$1:[]}),bX);};Y=S.T=bQ.Class({MoveNext:function(){return this.n(this);},Current:function(){return this.c;},Dispose:function(){if(this.d)this.d(this);}},m,Y);Y.New=bQ.Ctor(function(bX,bY,bZ,b0){m.New.call(this);this.s=bX;this.c=bY;this.n=bZ;this.d=b0;},Y);Z=n.Elt=bQ.Class({},r,Z);Z.New=function(bX,bY,bZ){var b0,b1;b0=_.CreateElemNode(bX,bY,bZ.docNode);b1=$.Create(bZ.updates);return new Z.New$1({$:1,$0:b0},H.Map2Unit(F.Updates(b0.Attr),b1.v),bX,b1);};Z.New$1=bQ.Ctor(function(bX,bY,bZ,b0){r.New.call(this,bX,bY);this.docNode$1=bX;this.updates$1=bY;this.elt=bZ;this.rvUpdates=b0;},Z);_1.New=function(bX,bY,bZ,b0){var b1;b1={DynElem:bX,DynFlags:bY,DynNodes:bZ};bQ.SetOptional(b1,"OnAfterRender",b0);return b1;};P.Obsolete=function(bX){var bY,bZ,b0,b1,b2;bZ=bX.s;if(bZ==null||(bZ!=null&&bZ.$==2?(bY=bZ.$1,false):bZ!=null&&bZ.$==3?(bY=bZ.$1,false):true))void 0;else{bX.s=null;for(b0=0,b1=I.length(bY)-1;b0<=b1;b0++){b2=I.get(bY,b0);typeof b2=="object"?function(b3){P.Obsolete(b3);}(b2):b2();}}};P.New=function(bX){return{s:bX};};_2.notPresent=function(){return l.FailWith("The given key was not present in the dictionary.");};_3.convertTextNode=function(bX){var bY,bZ,b0,b1,b2,b3;bY=null;bZ=0;b1=bX.textContent;b2=new a.RegExp(B.TextHoleRE(),"g");while(bY=b2.exec(b1),bY!==null){bX.parentNode.insertBefore(self.document.createTextNode(_4.string(b1,{$:1,$0:bZ},{$:1,$0:b2.lastIndex-I.get(bY,0).length-1})),bX);bZ=b2.lastIndex;b3=self.document.createElement("span");b3.setAttribute("ws-replace",I.get(bY,1).toLowerCase());bX.parentNode.insertBefore(b3,bX);}b2.lastIndex=0;bX.textContent=_4.string(b1,{$:1,$0:bZ},null);};_3.failNotLoaded=function(bX){bS.warn("Instantiating non-loaded template",bX);};_3.fillTextHole=function(bX,bY,bZ){var b0;b0=bX.querySelector("[ws-replace]");return v.Equals(b0,null)?(bS.warn("Filling non-existent text hole",bZ),null):(b0.parentNode.replaceChild(new a.Text(bY),b0),{$:1,$0:b0.getAttribute("ws-replace")});};_3.removeHolesExcept=function(bX,bY){function bZ(b0){G.IterSelector(bX,"["+b0+"]",function(b1){if(!bY.Contains(b1.getAttribute(b0)))b1.removeAttribute(b0);});}bZ("ws-attr");bZ("ws-onafterrender");bZ("ws-var");G.IterSelector(bX,"[ws-hole]",function(b0){if(!bY.Contains(b0.getAttribute("ws-hole"))){b0.removeAttribute("ws-hole");while(b0.hasChildNodes())b0.removeChild(b0.lastChild);}});G.IterSelector(bX,"[ws-replace]",function(b0){if(!bY.Contains(b0.getAttribute("ws-replace")))b0.parentNode.removeChild(b0);});G.IterSelector(bX,"[ws-on]",function(b0){b0.setAttribute("ws-on",ba.concat(" ",I.filter(function(b1){return bY.Contains(I.get(ba.SplitChars(b1,[":"],1),1));},ba.SplitChars(b0.getAttribute("ws-on"),[" "],1))));});G.IterSelector(bX,"[ws-attr-holes]",function(b0){var b1,b2,b3,b4,b5;b1=ba.SplitChars(b0.getAttribute("ws-attr-holes"),[" "],1);for(b2=0,b3=b1.length-1;b2<=b3;b2++){b4=I.get(b1,b2);b0.setAttribute(b4,(b5=new a.RegExp(B.TextHoleRE(),"g"),b0.getAttribute(b4).replace(b5,function(b6,b7){return bY.Contains(b7)?b6:"";})));}});};_3.fillInstanceAttrs=function(bX,bY){var bZ,b0,b1,b2,b3;_3.convertAttrs(bY);bZ=bY.nodeName.toLowerCase();b0=bX.querySelector("[ws-attr="+bZ+"]");if(v.Equals(b0,null))bS.warn("Filling non-existent attr hole",bZ);else{b0.removeAttribute("ws-attr");for(b1=0,b2=bY.attributes.length-1;b1<=b2;b1++){b3=bY.attributes.item(b1);b3.name==="class"&&b0.hasAttribute("class")?b0.setAttribute("class",b0.getAttribute("class")+" "+b3.nodeValue):b0.setAttribute(b3.name,b3.nodeValue);}}};_3.mapHoles=function(bX,bY){function bZ(b0){G.IterSelector(bX,"["+b0+"]",function(b1){var b2,b3;b2=(b3=null,[bY.TryGetValue(b1.getAttribute(b0).toLowerCase(),{get:function(){return b3;},set:function(b4){b3=b4;}}),b3]);b2[0]?b1.setAttribute(b0,b2[1]):void 0;});}bZ("ws-hole");bZ("ws-replace");bZ("ws-attr");bZ("ws-onafterrender");bZ("ws-var");G.IterSelector(bX,"[ws-on]",function(b0){b0.setAttribute("ws-on",ba.concat(" ",I.map(function(b1){var b2,b3,b4;b2=ba.SplitChars(b1,[":"],1);b3=(b4=null,[bY.TryGetValue(I.get(b2,1),{get:function(){return b4;},set:function(b5){b4=b5;}}),b4]);return b3[0]?I.get(b2,0)+":"+b3[1]:b1;},ba.SplitChars(b0.getAttribute("ws-on"),[" "],1))));});G.IterSelector(bX,"[ws-attr-holes]",function(b0){var b1,b2,b3;b1=ba.SplitChars(b0.getAttribute("ws-attr-holes"),[" "],1);for(b2=0,b3=b1.length-1;b2<=b3;b2++)(function(){var b4;function b5(b6,b7){var b8;b8=l.KeyValue(b7);return b6.replace(new a.RegExp("\\${"+b8[0]+"}","ig"),"${"+b8[1]+"}");}b4=I.get(b1,b2);return b0.setAttribute(b4,(((bQ.Curried3(M.fold))(b5))(b0.getAttribute(b4)))(bY));}());});};_3.fill=function(bX,bY,bZ){while(true)if(bX.hasChildNodes())bZ=bY.insertBefore(bX.lastChild,bZ);else return null;};_3.convertAttrs=function(bX){var bZ,b0,b1,b2,b3,b4,b5,b6;function bY(b7){var b8;b8=bX.getAttribute(b7);b8===null?void 0:bX.setAttribute(b7,b8.toLowerCase());}bZ=bX.attributes;b0=[];b1=[];b2=[];for(b3=0,b4=bZ.length-1;b3<=b4;b3++){b5=bZ.item(b3);ba.StartsWith(b5.nodeName,"ws-on")&&b5.nodeName!=="ws-onafterrender"&&b5.nodeName!=="ws-on"?(b0.push(b5.nodeName),b1.push(_4.string(b5.nodeName,{$:1,$0:"ws-on".length},null)+":"+b5.nodeValue.toLowerCase())):!ba.StartsWith(b5.nodeName,"ws-")&&(new a.RegExp(B.TextHoleRE())).test(b5.nodeValue)?(b5.nodeValue=(b6=new a.RegExp(B.TextHoleRE(),"g"),b5.nodeValue.replace(b6,function(b7,b8){return"${"+b8.toLowerCase()+"}";})),b2.push(b5.nodeName)):void 0;}!(b1.length==0)?bX.setAttribute("ws-on",ba.concat(" ",b1)):void 0;!(b2.length==0)?bX.setAttribute("ws-attr-holes",ba.concat(" ",b2)):void 0;bY("ws-hole");bY("ws-replace");bY("ws-attr");bY("ws-onafterrender");bY("ws-var");I.iter(function(b7){bX.removeAttribute(b7);},b0);};_4.string=function(bX,bY,bZ){return bY==null?bZ!=null&&bZ.$==1?bX.slice(0,bZ.$0+1):"":bZ==null?bX.slice(bY.$0):bX.slice(bY.$0,bZ.$0+1);};M.insufficient=function(){return l.FailWith("The input sequence has an insufficient number of elements.");};_5=K.KeyCollection=bQ.Class({GetEnumerator$1:function(){return S.Get(M.map(function(bX){return bX.K;},this.d));},GetEnumerator:function(){return this.GetEnumerator$1();},GetEnumerator0:function(){return this.GetEnumerator$1();}},m,_5);_5.New=bQ.Ctor(function(bX){m.New.call(this);this.d=bX;},_5);_6.StopCurrent=function(){var bX,bY;bX=_6.currentPlaying();bX==null?void 0:bX.$0.disconnect();bY=_6.jsNode();bY==null?void 0:bY.$0.disconnect();};_6.currentPlaying=function(){br.$cctor();return br.currentPlaying;};_6.jsNode=function(){br.$cctor();return br.jsNode;};_6.SetCurrent=function(bX,bY){_6.set_currentPlaying({$:1,$0:bX});_6.set_jsNode({$:1,$0:bY});};_6.set_currentPlaying=function(bX){br.$cctor();br.currentPlaying=bX;};_6.set_jsNode=function(bX){br.$cctor();br.jsNode=bX;};_7=n.Var=bQ.Class({},m,_7);_7.New=bQ.Ctor(function(){m.New.call(this);},_7);_8=n.ConcreteVar=bQ.Class({get_View:function(){return this.view;},Set:function(bX){if(this.isConst)(function(bY){return bY("WebSharper.UI: invalid attempt to change value of a Var after calling SetFinal");}(function(bY){bS.log(bY);}));else{P.Obsolete(this.snap);this.current=bX;this.snap=P.New({$:2,$0:bX,$1:[]});}}},_7,_8);_8.New=bQ.Ctor(function(bX,bY,bZ){var b0;b0=this;_7.New.call(this);this.isConst=bX;this.current=bZ;this.snap=bY;this.view=function(){return b0.snap;};this.id=bf.Int();},_8);_9.InitVideoStream=function(bX,bY){D.UserMedia();bU.getUserMedia({video:true,audio:false},function(bZ){bX.src=a.URL&&bV.createObjectURL(bZ)||bZ;},bY);return bi.New(bX,null,false);};_9.Start=function(bX,bY){bY.Video.play();return bi.New(bY.Video,{$:1,$0:a.requestAnimFrame(function(){_9.FrameFun(bY,bX,void 0);})},true);};_9.FrameFun=function(bX,bY,bZ){bY(bX);a.requestAnimFrame(function(){_9.FrameFun(bX,bY,void 0);});};_.CreateElemNode=function(bX,bY,bZ){var b0;_.LinkElement(bX,bZ);b0=F.Insert(bX,bY);return Q.New(b0,bZ,null,bX,bf.Int(),bQ.GetOptional(b0.OnAfterRender));};_.LinkPrevElement=function(bX,bY){_.InsertDoc(bX.parentNode,bY,bX);};_.CreateDelimitedRunState=function(bX,bY,bZ){return bn.New(bo.get_Empty(),_.CreateDelimitedElemNode(bX,bY,F.EmptyAttr(),bZ));};_.PerformAnimatedUpdate=function(bX,bY,bZ){var b0;return bb.get_UseAnimations()?(b0=null,by.Delay(function(){var b1,b2,b3;b1=bo.FindAll(bZ);b2=_.ComputeChangeAnim(bY,b1);b3=_.ComputeEnterAnim(bY,b1);return by.Bind(bb.Play(bb.Append(b2,_.ComputeExitAnim(bY,b1))),function(){return by.Bind(_.SyncElemNodesNextFrame(bX,bY),function(){return by.Bind(bb.Play(b3),function(){bY.PreviousNodes=b1;return by.Return(null);});});});})):_.SyncElemNodesNextFrame(bX,bY);};_.PerformSyncUpdate=function(bX,bY,bZ){var b0;b0=bo.FindAll(bZ);_.SyncElemNode(bX,bY.Top);bY.PreviousNodes=b0;};_.LinkElement=function(bX,bY){_.InsertDoc(bX,bY,null);};_.InsertDoc=function(bX,bY,bZ){var b0;return bY!=null&&bY.$==1?_.InsertNode(bX,bY.$0.El,bZ):bY!=null&&bY.$==2?(b0=bY.$0,(b0.Dirty=false,_.InsertDoc(bX,b0.Current,bZ))):bY==null?bZ:bY!=null&&bY.$==4?_.InsertNode(bX,bY.$0.Text,bZ):bY!=null&&bY.$==5?_.InsertNode(bX,bY.$0,bZ):bY!=null&&bY.$==6?I.foldBack(function(b1,b2){return b1==null||b1.constructor===J?_.InsertDoc(bX,b1,b2):_.InsertNode(bX,b1,b2);},bY.$0.Els,bZ):_.InsertDoc(bX,bY.$0,_.InsertDoc(bX,bY.$1,bZ));};_.CreateDelimitedElemNode=function(bX,bY,bZ,b0){var b1,b2;b1=bX.parentNode;_.LinkPrevElement(bY,b0);b2=F.Insert(b1,bZ);return Q.New(b2,b0,{$:1,$0:[bX,bY]},b1,bf.Int(),bQ.GetOptional(b2.OnAfterRender));};_.SyncElemNodesNextFrame=function(bX,bY){function bZ(b0){a.requestAnimationFrame(function(){_.SyncElemNode(bX,bY.Top);b0();});}return bc.BatchUpdatesEnabled()?by.FromContinuations(function(b0,b1,b2){return bZ.apply(null,[b0,b1,b2]);}):(_.SyncElemNode(bX,bY.Top),by.Return(null));};_.ComputeExitAnim=function(bX,bY){return bb.Concat(I.map(function(bZ){return F.GetExitAnim(bZ.Attr);},bo.ToArray(bo.Except(bY,bo.Filter(function(bZ){return F.HasExitAnim(bZ.Attr);},bX.PreviousNodes)))));};_.ComputeEnterAnim=function(bX,bY){return bb.Concat(I.map(function(bZ){return F.GetEnterAnim(bZ.Attr);},bo.ToArray(bo.Except(bX.PreviousNodes,bo.Filter(function(bZ){return F.HasEnterAnim(bZ.Attr);},bY)))));};_.ComputeChangeAnim=function(bX,bY){var bZ;function b0(b1){return F.HasChangeAnim(b1.Attr);}bZ=function(b1){return bo.Filter(b0,b1);};return bb.Concat(I.map(function(b1){return F.GetChangeAnim(b1.Attr);},bo.ToArray(bo.Intersect(bZ(bX.PreviousNodes),bZ(bY)))));};_.SyncElemNode=function(bX,bY){!bX?_.SyncElement(bY):void 0;_.Sync(bY.Children);_.AfterRender(bY);};_.CreateTextNode=function(){return{Text:G.CreateText(""),Dirty:false,Value:""};};_.UpdateTextNode=function(bX,bY){bX.Value=bY;bX.Dirty=true;};_.InsertNode=function(bX,bY,bZ){G.InsertAt(bX,bZ,bY);return bY;};_.SyncElement=function(bX){function bY(bZ){function b0(b1){var b2,b3;return b1!=null&&b1.$==0?b0(b1.$0)||b0(b1.$1):b1!=null&&b1.$==2?(b2=b1.$0,b2.Dirty||b0(b2.Current)):b1!=null&&b1.$==6&&(b3=b1.$0,b3.Dirty||I.exists(bY,b3.Holes));}return b0(bZ.Children);}F.Sync(bX.El,bX.Attr);bY(bX)?_.DoSyncElement(bX):void 0;};_.Sync=function(bX){var bY,bZ;if(bX!=null&&bX.$==1)_.SyncElemNode(false,bX.$0);else if(bX!=null&&bX.$==2)_.Sync(bX.$0.Current);else if(bX==null);else if(bX!=null&&bX.$==5);else if(bX!=null&&bX.$==4){bY=bX.$0;bY.Dirty?(bY.Text.nodeValue=bY.Value,bY.Dirty=false):void 0;}else if(bX!=null&&bX.$==6){bZ=bX.$0;I.iter(function(b0){_.SyncElemNode(false,b0);},bZ.Holes);I.iter(function(b0){F.Sync(b0[0],b0[1]);},bZ.Attrs);_.AfterRender(bZ);}else{_.Sync(bX.$0);_.Sync(bX.$1);}};_.AfterRender=function(bX){var bY;bY=bQ.GetOptional(bX.Render);bY!=null&&bY.$==1?(bY.$0(bX.El),bQ.SetOptional(bX,"Render",null)):void 0;};_.CreateRunState=function(bX,bY){return bn.New(bo.get_Empty(),_.CreateElemNode(bX,F.EmptyAttr(),bY));};_.DoSyncElement=function(bX){var bY,bZ,b0;function b1(b2,b3){var b4,b5;return b2!=null&&b2.$==1?b2.$0.El:b2!=null&&b2.$==2?(b4=b2.$0,b4.Dirty?(b4.Dirty=false,_.InsertDoc(bY,b4.Current,b3)):b1(b4.Current,b3)):b2==null?b3:b2!=null&&b2.$==4?b2.$0.Text:b2!=null&&b2.$==5?b2.$0:b2!=null&&b2.$==6?(b5=b2.$0,(b5.Dirty?b5.Dirty=false:void 0,I.foldBack(function(b6,b7){return b6==null||b6.constructor===J?b1(b6,b7):b6;},b5.Els,b3))):b1(b2.$0,b1(b2.$1,b3));}bY=bX.El;bI.Iter((bZ=bX.El,function(b2){G.RemoveNode(bZ,b2);}),bI.Except(bI.DocChildren(bX),bI.Children(bX.El,bQ.GetOptional(bX.Delimiters))));b1(bX.Children,(b0=bQ.GetOptional(bX.Delimiters),b0!=null&&b0.$==1?b0.$0[1]:null));};_.CreateEmbedNode=function(){return{Current:null,Dirty:false};};_.UpdateEmbedNode=function(bX,bY){bX.Current=bY;bX.Dirty=true;};$=n.Updates=bQ.Class({},null,$);$.Create=function(bX){var bY;bY=null;bY=$.New(bX,null,function(){var bZ;bZ=bY.s;return bZ===null?(bZ=P.Copy(bY.c()),bY.s=bZ,P.WhenObsoleteRun(bZ,function(){bY.s=null;}),bZ):bZ;});return bY;};$.New=function(bX,bY,bZ){return new $({c:bX,s:bY,v:bZ});};ba.concat=function(bX,bY){return I.ofSeq(bY).join(bX);};ba.SplitChars=function(bX,bY,bZ){return ba.Split(bX,new a.RegExp("["+ba.RegexEscape(bY.join(""))+"]"),bZ);};ba.StartsWith=function(bX,bY){return bX.substring(0,bY.length)==bY;};ba.Split=function(bX,bY,bZ){return bZ===1?I.filter(function(b0){return b0!=="";},ba.SplitWith(bX,bY)):ba.SplitWith(bX,bY);};ba.RegexEscape=function(bX){return bX.replace(new a.RegExp("[-\\/\\\\^$*+?.()|[\\]{}]","g"),"\\$&");};ba.SplitWith=function(bX,bY){return bX.split(bY);};bb.get_UseAnimations=function(){return bp.UseAnimations();};bb.Play=function(bX){var bY;bY=null;return by.Delay(function(){return by.Bind(bb.Run(a.ignore,bp.Actions(bX)),function(){bp.Finalize(bX);return by.Return(null);});});};bb.Append=function(bX,bY){return{$:0,$0:bz.Append(bX.$0,bY.$0)};};bb.Run=function(bX,bY){var bZ;function b0(b1){function b2(b3,b4){var b5;b5=b4-b3;bY.Compute(b5);bX();return b5<=bZ?void a.requestAnimationFrame(function(b6){b2(b3,b6);}):b1();}a.requestAnimationFrame(function(b3){b2(b3,b3);});}bZ=bY.Duration;return bZ===0?by.Zero():by.FromContinuations(function(b1,b2,b3){return b0.apply(null,[b1,b2,b3]);});};bb.Concat=function(bX){return{$:0,$0:bz.Concat(M.map(bp.List,bX))};};bc.BatchUpdatesEnabled=function(){bq.$cctor();return bq.BatchUpdatesEnabled;};be.StartProcessor=function(bX){var bY;function bZ(){var b0;b0=null;return by.Delay(function(){return by.Bind(bX,function(){var b1;b1=bY[0];return b1===1?(bY[0]=0,by.Zero()):b1===2?(bY[0]=1,bZ()):by.Zero();});});}bY=[0];return function(){var b0;b0=bY[0];b0===0?(bY[0]=1,by.Start(bZ(),null)):b0===1?bY[0]=2:void 0;};};bf.Int=function(){bf.set_counter(bf.counter()+1);return bf.counter();};bf.set_counter=function(bX){bA.$cctor();bA.counter=bX;};bf.counter=function(){bA.$cctor();return bA.counter;};bi.New=function(bX,bY,bZ){return{Video:bX,Handle:bY,Playing:bZ};};bk.AsciiFromCanvas=function(bX){var bY,bZ,b0,b1,b2,b3,b4,b5,b6,b7,b8,b9;b1=bX.getContext("2d");b2=bX.width;b3=bX.height;b4=128;b5=259*(b4+255)/(255*(259-b4));b6=b1.getImageData(0,0,b2,b3);bY=0;bZ=0;b0="";while(bZ<b3){bY=0;while(bY<b2){b7=(bZ*b2+bY)*4;b8=bk.GetColorAtOffset(b6.data,b7);b9=bu.New(bk.Bound(l.toInt(bR.floor((b8.Red-128)*b5)+128),0,255),bk.Bound(l.toInt(bR.floor((b8.Green-128)*b5)+128),0,255),bk.Bound(l.toInt(bR.floor((b8.Blue-128)*b5)+128),0,255),b8.Alpha);b0=b0+(bk.characters())[bk.characters().length-1-l.toInt(bR.round((0.299*b9.Red+0.587*b9.Green+0.114*b9.Blue)/255*(bk.characters().length-1)))];bY=bY+1;}b0=b0+"\n";bZ=bZ+2;}return b0;};bk.GetColorAtOffset=function(bX,bY){return bu.New(I.get(bX,bY),I.get(bX,bY+1),I.get(bX,bY+2),I.get(bX,bY+3));};bk.Bound=function(bX,bY,bZ){var b0;b0=v.Compare(bZ,bX)===-1?bZ:bX;return v.Compare(bY,b0)===1?bY:b0;};bk.characters=function(){O.$cctor();return O.characters;};bl.$cctor=function(){bl.$cctor=a.ignore;bl.EmptyAttr=null;};bn.New=function(bX,bY){return{PreviousNodes:bX,Top:bY};};bo.get_Empty=function(){return{$:0,$0:new U.New$3()};};bo.FindAll=function(bX){var bY;function bZ(b1){if(b1!=null&&b1.$==0){bZ(b1.$0);bZ(b1.$1);}else if(b1!=null&&b1.$==1)b0(b1.$0);else if(b1!=null&&b1.$==2)bZ(b1.$0.Current);else if(b1!=null&&b1.$==6)I.iter(b0,b1.$0.Holes);}function b0(b1){bY.push(b1);bZ(b1.Children);}bY=[];bZ(bX);return{$:0,$0:new U.New$2(bY)};};bo.Filter=function(bX,bY){return{$:0,$0:bF.Filter(bX,bY.$0)};};bo.Except=function(bX,bY){return{$:0,$0:bF.Except(bX.$0,bY.$0)};};bo.ToArray=function(bX){return bF.ToArray(bX.$0);};bo.Intersect=function(bX,bY){return{$:0,$0:bF.Intersect(bX.$0,bY.$0)};};bp.UseAnimations=function(){bx.$cctor();return bx.UseAnimations;};bp.Actions=function(bX){return bp.ConcatActions(I.choose(function(bY){return bY.$==1?{$:1,$0:bY.$0}:null;},bz.ToArray(bX.$0)));};bp.Finalize=function(bX){I.iter(function(bY){if(bY.$==0)bY.$0();},bz.ToArray(bX.$0));};bp.ConcatActions=function(bX){var bY,bZ,b0,b1;bY=z.ofSeqNonCopying(bX);bZ=I.length(bY);return bZ===0?bp.Const():bZ===1?I.get(bY,0):(b0=M.max(M.map(function(b2){return b2.Duration;},bY)),(b1=I.map(function(b2){return bp.Prolong(b0,b2);},bY),bp.Def(b0,function(b2){I.iter(function(b3){b3.Compute(b2);},b1);})));};bp.List=function(bX){return bX.$0;};bp.Const=function(bX){return bp.Def(0,function(){return bX;});};bp.Def=function(bX,bY){return{Compute:bY,Duration:bX};};bp.Prolong=function(bX,bY){var bZ,b0,b1;bZ=bY.Compute;b0=bY.Duration;b1=bL.Create(function(){return bY.Compute(bY.Duration);});return{Compute:function(b2){return b2>=b0?b1.f():bZ(b2);},Duration:bX};};bq.$cctor=function(){bq.$cctor=a.ignore;bq.BatchUpdatesEnabled=true;};br.$cctor=function(){br.$cctor=a.ignore;br.currentPlaying=null;br.jsNode=null;};bu.New=function(bX,bY,bZ,b0){return{Red:bX,Green:bY,Blue:bZ,Alpha:b0};};bv.concat=function(bX){var bY,bZ;bY=[];for(var b0 in bX)bY.push.apply(bY,bX[b0]);return bY;};bw.Clear=function(bX){bX.splice(0,I.length(bX));};bx.$cctor=function(){bx.$cctor=a.ignore;bx.CubicInOut=bB.Custom(function(bX){var bY;bY=bX*bX;return 3*bY-2*(bY*bX);});bx.UseAnimations=true;};by.Delay=function(bX){return function(bY){try{(bX(null))(bY);}catch(bZ){bY.k({$:1,$0:bZ});}};};by.Bind=function(bX,bY){return by.checkCancel(function(bZ){bX(bC.New(function(b0){var b1;if(b0.$==0){b1=b0.$0;by.scheduler().Fork(function(){try{(bY(b1))(bZ);}catch(b2){bZ.k({$:1,$0:b2});}});}else by.scheduler().Fork(function(){bZ.k(b0);});},bZ.ct));});};by.Zero=function(){bD.$cctor();return bD.Zero;};by.Start=function(bX,bY){var bZ,b0;bZ=(b0=(by.defCTS())[0],bY==null?b0:bY.$0);by.scheduler().Fork(function(){if(!bZ.c)bX(bC.New(function(b1){if(b1.$==1)by.UncaughtAsyncError(b1.$0);},bZ));});};by.Return=function(bX){return function(bY){bY.k({$:0,$0:bX});};};by.checkCancel=function(bX){return function(bY){if(bY.ct.c)by.cancel(bY);else bX(bY);};};by.defCTS=function(){bD.$cctor();return bD.defCTS;};by.UncaughtAsyncError=function(bX){bS.log("WebSharper: Uncaught asynchronous exception",bX);};by.FromContinuations=function(bX){return function(bY){var bZ;function b0(b1){if(bZ[0])l.FailWith("A continuation provided by Async.FromContinuations was invoked multiple times");else{bZ[0]=true;by.scheduler().Fork(b1);}}bZ=[false];bX(function(b1){b0(function(){bY.k({$:0,$0:b1});});},function(b1){b0(function(){bY.k({$:1,$0:b1});});},function(b1){b0(function(){bY.k({$:2,$0:b1});});});};};by.cancel=function(bX){bX.k({$:2,$0:new bK.New(bX.ct)});};by.scheduler=function(){bD.$cctor();return bD.scheduler;};bz.Append=function(bX,bY){return bX.$==0?bY:bY.$==0?bX:{$:2,$0:bX,$1:bY};};bz.ToArray=function(bX){var bY;function bZ(b0){if(b0.$==1)bY.push(b0.$0);else if(b0.$==2){bZ(b0.$0);bZ(b0.$1);}else if(b0.$==3)I.iter(function(b1){bY.push(b1);},b0.$0);}bY=[];bZ(bX);return bY.slice(0);};bz.Concat=function(bX){var bY;bY=z.ofSeqNonCopying(bX);return z.TreeReduce(bz.Empty(),bz.Append,bY);};bz.Empty=function(){bM.$cctor();return bM.Empty;};bA.$cctor=function(){bA.$cctor=a.ignore;bA.counter=0;};bB=n.Easing=bQ.Class({},m,bB);bB.Custom=function(bX){return new bB.New(bX);};bB.New=bQ.Ctor(function(bX){m.New.call(this);this.transformTime=bX;},bB);bC.New=function(bX,bY){return{k:bX,ct:bY};};bD.$cctor=function(){bD.$cctor=a.ignore;bD.noneCT=bE.New(false,[]);bD.scheduler=new bG.New();bD.defCTS=[new bH.New()];bD.Zero=by.Return();bD.GetCT=function(bX){bX.k({$:0,$0:bX.ct});};};bE.New=function(bX,bY){return{c:bX,r:bY};};bF.Filter=function(bX,bY){return new U.New$2(I.filter(bX,bF.ToArray(bY)));};bF.Except=function(bX,bY){var bZ;bZ=new U.New$2(bF.ToArray(bY));bZ.ExceptWith(bF.ToArray(bX));return bZ;};bF.ToArray=function(bX){var bY;bY=I.create(bX.get_Count(),void 0);bX.CopyTo(bY);return bY;};bF.Intersect=function(bX,bY){var bZ;bZ=new U.New$2(bF.ToArray(bX));bZ.IntersectWith(bF.ToArray(bY));return bZ;};bG=by.Scheduler=bQ.Class({Fork:function(bX){var bY;bY=this;this.robin.push(bX);this.idle?(this.idle=false,a.setTimeout(function(){bY.tick();},0)):void 0;},tick:function(){var bX,bY,bZ;bY=this;bZ=bW.now();bX=true;while(bX)if(this.robin.length===0){this.idle=true;bX=false;}else{(this.robin.shift())();bW.now()-bZ>40?(a.setTimeout(function(){bY.tick();},0),bX=false):void 0;}}},m,bG);bG.New=bQ.Ctor(function(){m.New.call(this);this.idle=true;this.robin=[];},bG);bH=h.CancellationTokenSource=bQ.Class({},m,bH);bH.New=bQ.Ctor(function(){m.New.call(this);this.c=false;this.pending=null;this.r=[];this.init=1;},bH);bI.Children=function(bX,bY){var bZ,b0,b1;if(bY!=null&&bY.$==1){b1=[];bZ=bY.$0[0].nextSibling;while(bZ!==bY.$0[1]){b1.push(bZ);bZ=bZ.nextSibling;}return{$:0,$0:b1};}else return{$:0,$0:I.init(bX.childNodes.length,(b0=bX.childNodes,function(b2){return b0[b2];}))};};bI.Except=function(bX,bY){var bZ;bZ=bX.$0;return{$:0,$0:I.filter(function(b0){return I.forall(function(b1){return!(b0===b1);},bZ);},bY.$0)};};bI.Iter=function(bX,bY){I.iter(bX,bY.$0);};bI.DocChildren=function(bX){var bY;function bZ(b0){if(b0!=null&&b0.$==2)bZ(b0.$0.Current);else if(b0!=null&&b0.$==1)bY.push(b0.$0.El);else if(b0==null);else if(b0!=null&&b0.$==5)bY.push(b0.$0);else if(b0!=null&&b0.$==4)bY.push(b0.$0.Text);else if(b0!=null&&b0.$==6)I.iter(function(b1){if(b1==null||b1.constructor===J)bZ(b1);else bY.push(b1);},b0.$0.Els);else{bZ(b0.$0);bZ(b0.$1);}}bY=[];bZ(bX.Children);return{$:0,$0:z.ofSeqNonCopying(bY)};};bK=h.OperationCanceledException=bQ.Class({},bJ,bK);bK.New=bQ.Ctor(function(bX){bK.New$1.call(this,"The operation was canceled.",null,bX);},bK);bK.New$1=bQ.Ctor(function(bX,bY,bZ){this.message=bX;this.inner=bY;J.setPrototypeOf(this,bK.prototype);this.ct=bZ;},bK);bL.Create=function(bX){return bO.New(false,bX,bL.forceLazy);};bL.forceLazy=function(){var bX;bX=this.v();this.c=true;this.v=bX;this.f=bL.cachedLazy;return bX;};bL.cachedLazy=function(){return this.v;};bM.$cctor=function(){bM.$cctor=a.ignore;bM.Empty={$:0};};bO.New=function(bX,bY,bZ){return{c:bX,v:bY,f:bZ};};bQ.OnLoad(function(){c.Main();});}());


if (typeof IntelliFactory !=='undefined') {
  IntelliFactory.Runtime.ScriptBasePath = '/Content/';
  IntelliFactory.Runtime.Start();
}
